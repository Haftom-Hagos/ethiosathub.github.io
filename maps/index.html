<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EGSH-Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
  <nav class="navbars">
    <div class="nav-container">
      <div class="nav-logo">
        <a href="/home">EGSH</a>
      </div>
      <div class="hamburger" id="hamburger">☰</div>
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="/home" class="nav-link">Home</a>
        </li>
        <li class="nav-item">
          <a href="/maps" class="nav-link active">Maps</a>
        </li>
        <li class="nav-item">
          <a href="/data" class="nav-link">Data</a>
        </li>
        <li class="nav-item">
          <a href="/gallery" class="nav-link">Gallery</a>
        </li>
        <li class="nav-item">
          <a href="/about" class="nav-link">About</a>
        </li>
      </ul>
    </div>
  </nav>
  
  <div class="sub-contents">
    <div id="maps" class="tabcontent">
      <h2>Map view</h2>
      <p>Select a dataset, year, and district (or draw an area for NDVI) to visualize and download. Currently, this service works for small areas. For larger areas, access to more satellite sources, and additional vegetation indices, please use the Vegetation Indices app.</p>
      <div id="map"></div>
      <div class="filters">
        <label for="datasetSelect">Dataset:</label>
        <select id="datasetSelect">
          <option value="">Select Dataset</option>
          <option value="landcover">Land Cover</option>
          <option value="ndvi">NDVI</option>
        </select>
        <div id="landcoverOptions" style="display: none;">
          <label for="yearSelectLC">Year:</label>
          <select id="yearSelectLC">
            <option value="">Select Year</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
            <option value="2022">2022</option>
            <option value="2023">2023</option>
          </select>
        </div>
        <div id="ndviOptions" style="display: none;">
          <label for="yearSelect">Year:</label>
          <select id="yearSelect"></select>
          <label for="monthStart">From:</label>
          <select id="monthStart"></select>
          <label for="monthEnd">To:</label>
          <select id="monthEnd"></select>
        </div>
        <label for="districtSelect">District:</label>
        <select id="districtSelect">
          <option value="">Select a district</option>
        </select>
      </div>
      <div class="button-container">
        <button id="viewSelectionBtn">View Selection</button>
        <button id="downloadSelectionBtn">Download Selection</button>
      </div>
      <div>
        <a class="btn" href="https://ethiosathub-gee.projects.earthengine.app/view/vegind" target="_blank">
          Open Vegetation Indices App
        </a>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
  <script src="https://unpkg.com/esri-leaflet"></script>
  <script src="https://unpkg.com/proj4@2.7.5/dist/proj4.js"></script>
  <script src="../script.js"></script>
  <script>
    const hamburger = document.getElementById("hamburger");
    const navmenu = document.querySelector(".nav-menu");
    hamburger.addEventListener("click", () => {
      navmenu.classList.toggle("show");
      if (hamburger.textContent === "☰") {
        hamburger.textContent = "✖"; // change to X
      } else {
        hamburger.textContent = "☰"; // change back
      }
    });

    // Toggle visibility of land cover and NDVI options based on dataset selection
    const datasetSelect = document.getElementById('datasetSelect');
    const landcoverOptions = document.getElementById('landcoverOptions');
    const ndviOptions = document.getElementById('ndviOptions');

    datasetSelect.addEventListener('change', () => {
      landcoverOptions.style.display = datasetSelect.value === 'landcover' ? 'inline-block' : 'none';
      ndviOptions.style.display = datasetSelect.value === 'ndvi' ? 'inline-block' : 'none';
    });
  </script>
</body>
</html>
